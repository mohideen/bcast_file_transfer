<% (success_destinations, failed_destinations) = script_result.destination_results.partition(&:success?) %>

File Transfer OK

Job Name: <%= script_result.config_hash['job_name'] %>


Summary
-------

<% success_destinations.each do |ss| %>
  <%= ss.dest_name %>: <%= ss.transfer_results.select(&:success?).count %> files transferred.
<% end %>

Details
-------
<% success_destinations.each do |sd| %>
  dest_name: <%= sd.dest_name %>
  dest_type: <%= sd.dest_type %>

  dest_directory: <%= sd.dest_directory %>

  <% successful_transfer_count = sd.transfer_results.select(&:success?).count %>
  <% total_transfer_count = sd.transfer_results.count %>

  <% if total_transfer_count == 0 %>
    No files needed to be transferred.
  <% else %>
    <%= successful_transfer_count %> of <%= total_transfer_count %> files transferred successfully.

    Files Transferred
    -----------------
    <% sd.transfer_results.each do |t| %>
        <%= t.file %>

    <% end %>
  <% end %>

  -----------------------------

<% end %>

<% if script_result.move_results.any? %>
  <%= script_result.move_results.count %> file(s) were moved on the source server:
  <% script_result.move_results.each do |m| %>
    <%= m.old_location %> to <%= m.new_location %>

  <% end %>
<% end %>

<% if script_result.prune_results.any? %>
  <%= script_result.prune_results.count %> empty directories on the source server were pruned:
  <% script_result.prune_results.each do |p| %>
    <%= p.dir_name %>

  <% end %>
<% end %>
